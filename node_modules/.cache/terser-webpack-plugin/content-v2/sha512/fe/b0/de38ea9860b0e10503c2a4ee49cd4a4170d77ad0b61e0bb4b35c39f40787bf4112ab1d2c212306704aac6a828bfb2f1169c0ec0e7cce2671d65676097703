{"code":"!function(t){var e={};function o(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=e,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},o.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var n in t)o.d(r,n,function(e){return t[e]}.bind(null,n));return r},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,\"a\",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p=\"\",o(o.s=0)}([function(t,e,o){o(1),o(2)},function(t,e){$(document).ready(function(){var t=$(\"#example\"),e=t.parent(),o=t.width()/2,r=t.height()/2;t.panzoom(),t.panzoom(\"pan\",-o+e.width()/2,-r+e.height()/2);var n=[.5,.75,1,2,3],i=2;e.on(\"mousewheel.focal\",function(e){e.preventDefault();var o=e.delta||e.originalEvent.wheelDelta||e.originalEvent.detail,r=o?o<0:e.originalEvent.deltaY>0;i=Math.max(0,Math.min(n.length-1,i+(2*r-1))),t.flowchart(\"setPositionRatio\",n[i]),t.panzoom(\"zoom\",n[i],{animate:!1,focal:e})});function a(t){var e=parseInt(t.data(\"nb-inputs\")),o=parseInt(t.data(\"nb-outputs\")),r=t.data(\"shape\"),n=t.data(\"function\");let i=\"decider\"==n?Math.random().toString(36).substring(7):null;var a={properties:{title:t.text(),inputs:{},outputs:{},shape:r,func:n,random:i}},s=0;for(s=0;s<e;s++)a.properties.inputs[\"input_\"+s]={label:\"\"};for(s=0;s<o;s++)a.properties.outputs[\"output_\"+s]={label:\"\"};return a}function s(t,e,o,r){var n={properties:{title:o,inputs:{},outputs:{},shape:\"rectangle\",random:r}},i=0;for(i=0;i<t;i++)n.properties.inputs[\"input_\"+i]={label:\"\"};for(i=0;i<e;i++)n.properties.outputs[\"output_\"+i]={label:\"\"};return n}t.flowchart({data:{},linkWidth:5}),t.parent().siblings(\".delete_selected_button\").click(function(){t.flowchart(\"deleteSelected\")});$(\".draggable_operator\").draggable({cursor:\"move\",opacity:.7,helper:\"clone\",appendTo:\"body\",zIndex:1e3,helper:function(e){var o=a($(this));return console.log(\"operatorDataSource\",o),t.flowchart(\"getOperatorElement\",o)},stop:function(o,r){console.log(o);var n=$(this),i=r.offset;console.log(r.offset);var l=e.offset();if(console.log(l),i.left>l.left&&i.top>l.top&&i.left<l.left+e.width()&&i.top<l.top+e.height()){var p=t.offset(),c=i.left-p.left;console.log(p.left),console.log(c);var u=i.top-p.top;console.log(\"flowchartOffset.top\",p.top),console.log(u);var d=t.flowchart(\"getPositionRatio\");c/=d,u/=d;var h=a(n);if(h.left=c,h.top=u,console.log(c,u),t.flowchart(\"addOperator\",h),\"decider\"==h.properties.func){var f=s(1,1,\"Approve\",h.properties.random),k=s(1,1,\"Reject\",h.properties.random);f.left=c-120,f.top=u+100,k.left=c+140,k.top=f.top,t.flowchart(\"addOperator\",f),t.flowchart(\"addOperator\",k)}}}})})},function(t,e){$(function(){$.widget(\"flowchart.flowchart\",{options:{canUserEditLinks:!0,canUserMoveOperators:!0,data:{},distanceFromArrow:3,defaultOperatorClass:\"flowchart-default-operator\",defaultLinkColor:\"pink\",defaultSelectedLinkColor:\"black\",linkWidth:10,grid:20,multipleLinksOnOutput:!1,multipleLinksOnInput:!1,linkVerticalDecal:0,onOperatorSelect:function(t){return!0},onOperatorUnselect:function(){return!0},onOperatorMouseOver:function(t){return!0},onOperatorMouseOut:function(t){return!0},onLinkSelect:function(t){return!0},onLinkUnselect:function(){return!0},onOperatorCreate:function(t,e,o){return!0},onLinkCreate:function(t,e){return!0},onOperatorDelete:function(t){return!0},onLinkDelete:function(t,e){return!0},onOperatorMoved:function(t,e){},onAfterChange:function(t){}},data:null,objs:null,maskNum:0,linkNum:0,operatorNum:0,lastOutputConnectorClicked:null,selectedOperatorId:null,selectedLinkId:null,positionRatio:1,globalId:null,_create:function(){void 0===document.__flowchartNumber?document.__flowchartNumber=0:document.__flowchartNumber++,this.globalId=document.__flowchartNumber,this._unitVariables(),this.element.addClass(\"flowchart-container\"),this.objs.layers.links=$('<svg class=\"flowchart-links-layer\"></svg>'),this.objs.layers.links.appendTo(this.element),this.objs.layers.operators=$('<div class=\"flowchart-operators-layer unselectable\"></div>'),this.objs.layers.operators.appendTo(this.element),this.objs.layers.temporaryLink=$('<svg class=\"flowchart-temporary-link-layer\"></svg>'),this.objs.layers.temporaryLink.appendTo(this.element);var t=document.createElementNS(\"http://www.w3.org/2000/svg\",\"line\");console.log(\"Shape\",t),t.setAttribute(\"x1\",\"0\"),t.setAttribute(\"y1\",\"0\"),t.setAttribute(\"x2\",\"0\"),t.setAttribute(\"y2\",\"0\"),t.setAttribute(\"stroke-width\",\"1\"),t.setAttribute(\"stroke\",\"black\"),t.setAttribute(\"fill\",\"none\"),this.objs.layers.temporaryLink[0].appendChild(t),this.objs.temporaryLink=$(\".flowchart-temporary-link-layer line:last-child\")[0],this._initEvents(),void 0!==this.options.data&&this.setData(this.options.data)},_unitVariables:function(){this.data={operators:{},links:{}},this.objs={layers:{operators:null,temporaryLink:null,links:null},linksContext:null,temporaryLink:null}},_initEvents:function(){var t=this;this.objs.layers.operators.on(\"dblclick\",\".flowchart-span-title\",function(t){$(t.target).next().show(),$(t.target).hide()}),this.objs.layers.operators.on(\"dblclick\",\".input-inside-operator\",function(t){t.target.value||/^\\s*$/.test(t.target.vale)?(console.log(\"enter key is pressed\"),$(t.target).prev().html($(t.target).val())):$(t.target).prev().html(\"Start\"),$(t.target).prev().show(),$(t.target).hide()}),this.objs.layers.operators.on(\"keypress\",\".input-inside-operator\",function(e){if(13==e.which){console.log(e.target.value),console.log(!/^\\s*$/.test(e.target.vale)),e.target.value||/^\\s*$/.test(e.target.vale)?(console.log(\"enter key is pressed\"),$(e.target).prev().html($(e.target).val())):$(e.target).prev().html(\"Start\");var o=$(e.target).parent().parent().parent().parent().parent().data(\"operator_id\");console.log(o);var r=t.data.operators;r[o].properties.title=$(e.target).val(),t.data.operators=r,console.log(t.data.operators),$(e.target).hide(),$(e.target).prev().show()}}),this.element.dblclick(function(e){if(console.log($(e.target).attr(\"class\")),\"flowchart-links-layer\"==$(e.target).attr(\"class\")){let e=$(\".flowchart-temporary-link-layer line:first-child\"),o=e.attr(\"x1\"),r=e.attr(\"y1\");e[0].setAttribute(\"x2\",o),e[0].setAttribute(\"y2\",r),$(\".flowchart-temporary-link-layer\").html(e),t.objs.temporaryLink=$(\".flowchart-temporary-link-layer line:last-child\")[0],t.lastOutputConnectorClicked=null}}),this.element.mousemove(function(e){var o=$(this).offset();console.log((e.pageX-o.left)/t.positionRatio,(e.pageY-o.top)/t.positionRatio),t._mousemove((e.pageX-o.left)/t.positionRatio,(e.pageY-o.top)/t.positionRatio,e)}),this.element.click(function(e){console.log($(e.target).attr(\"class\"));var o=$(this).offset();console.log(\"this.data.operators\",t.data.operators),console.log(\"this.data.links\",t.data.links),t._click((e.pageX-o.left)/t.positionRatio,(e.pageY-o.top)/t.positionRatio,e)}),this.objs.layers.operators.on(\"pointerdown mousedown touchstart\",\".flowchart-operator\",function(t){t.stopImmediatePropagation()}),this.objs.layers.operators.on(\"click\",\".flowchart-operator\",function(e){console.log(\"connector\",$(e.target).closest(\".flowchart-operator-connector\")),0==$(e.target).closest(\".flowchart-operator-connector\").length&&(t.selectOperator($(this).data(\"operator_id\")),console.log(\"Newly created operator\",$(this).data(\"operator_id\")))}),this.objs.layers.operators.on(\"click\",\".flowchart-operator-connector\",function(){console.log(\"Connector is now clicked!\");var e=$(this);console.log(e),t.options.canUserEditLinks&&t._connectorClicked(e.closest(\".flowchart-operator\").data(\"operator_id\"),e.data(\"connector\"),e.data(\"sub_connector\"),e.closest(\".flowchart-operator-connector-set\").data(\"connector_type\"))}),this.objs.layers.links.on(\"mouseover dblclick\",\".flowchart-link\",function(e){console.log(t.selectedLinkId),t._connecterMouseOver($(this).data(\"link_id\")),t.selectLink($(this).data(\"link_id\"))}),this.objs.layers.operators.on(\"mouseover\",\".flowchart-operator\",function(e){console.log($(this)),t._operatorMouseOver($(this).data(\"operator_id\")),console.log(\"mouseover\",$(this).data(\"operator_id\"))}),this.objs.layers.operators.on(\"mouseout\",\".flowchart-operator\",function(e){t._operatorMouseOut($(this).data(\"operator_id\"))})},setData:function(t){for(var e in console.log(\"setData\",t.operators,t.operatorTypes),this._clearOperatorsLayer(),this.data.operatorTypes={},void 0!==t.operatorTypes&&(this.data.operatorTypes=t.operatorTypes),this.data.operators={},t.operators)t.operators.hasOwnProperty(e)&&this.createOperator(e,t.operators[e]);for(var o in console.log(\"data.operators\",t.operators),this.data.links={},t.links)t.links.hasOwnProperty(o)&&this.createLink(o,t.links[o]);this.redrawLinksLayer()},addLink:function(t){for(console.log(\"links\",this.data.links),console.log(\"link.this.data.operators from addLink function\",this.data.operators);void 0!==this.data.links[this.linkNum];)this.linkNum++;return this.createLink(this.linkNum,t),this.linkNum},createLink:function(t,e){var o=$.extend(!0,{},e);if(this.callbackEvent(\"linkCreate\",[t,o])){console.log(\"Line 339 of createLink\",this.data.links);var r=this._getSubConnectors(o),n=r[0],i=r[1],a=this.options.multipleLinksOnOutput,s=this.options.multipleLinksOnInput;if(!a||!s)for(var l in this.data.links)if(this.data.links.hasOwnProperty(l)){var p=this.data.links[l],c=this._getSubConnectors(p),u=c[0],d=c[1];if(!a&&p.fromOperator==o.fromOperator&&p.fromConnector==o.fromConnector&&u==n){this.deleteLink(l);continue}s||p.toOperator!=o.toOperator||p.toConnector!=o.toConnector||d!=i||this.deleteLink(l)}this.data.links[t]=o,this._drawLink(t),this.callbackEvent(\"afterChange\",[\"link_create\"])}},_autoCreateSubConnector:function(t,e,o,r){var n=this.data.operators[t].properties[o][e];if(n.multiple){var i=this.data.operators[t].internal.els;console.log(\"fromFullElement\",i);var a=this.data.operators[t].internal.els.connectors[e].length;console.log(\"nbFromConnectors\",a);for(var s=a;s<r+2;s++)this._createSubConnector(e,n,i)}},redrawLinksLayer:function(){for(var t in this._clearLinksLayer(),this.data.links)this.data.links.hasOwnProperty(t)&&this._drawLink(t)},_clearLinksLayer:function(){this.objs.layers.links.empty(),this.objs.layers.operators.find(\".flowchart-operator-connector-small-arrow\").css(\"border-left-color\",\"transparent\")},_clearOperatorsLayer:function(){this.objs.layers.operators.empty()},getConnectorPosition:function(t,e,o){var r=this.data.operators[t].internal.els.connectorArrows[e][o],n=r.offset(),i=this.element.offset();return{x:(n.left-i.left)/this.positionRatio,width:parseInt(r.css(\"border-top-width\")),y:(n.top-i.top-1)/this.positionRatio+parseInt(r.css(\"border-left-width\"))}},getLinkMainColor:function(t){var e=this.options.defaultLinkColor,o=this.data.links[t];return void 0!==o.color&&(e=o.color),e},setLinkMainColor:function(t,e){this.data.links[t].color=e,this.callbackEvent(\"afterChange\",[\"link_change_main_color\"])},_drawLink:function(t){var e=this.data.links[t];void 0===e.internal&&(e.internal={}),e.internal.els={};var o=e.fromOperator,r=e.fromConnector,n=e.toOperator,i=e.toConnector,a=this._getSubConnectors(e),s=a[0],l=a[1],p=(this.getLinkMainColor(t),this.data.operators[o]),c=this.data.operators[n],u=p.internal.els.connectorSmallArrows[r][s],d=c.internal.els.connectorSmallArrows[i][l];e.internal.els.fromSmallConnector=u,e.internal.els.toSmallConnector=d,console.log(\"linkData.internal.els\",e.internal.els);var h=document.createElementNS(\"http://www.w3.org/2000/svg\",\"g\");this.objs.layers.links[0].appendChild(h);var f=document.createElementNS(\"http://www.w3.org/2000/svg\",\"line\"),k=document.createElementNS(\"http://www.w3.org/2000/svg\",\"line\"),b=document.createElementNS(\"http://www.w3.org/2000/svg\",\"line\"),v=document.createElementNS(\"http://www.w3.org/2000/svg\",\"line\"),m=document.createElementNS(\"http://www.w3.org/2000/svg\",\"line\");e.internal.els.overallGroup=h;var g=document.createElementNS(\"http://www.w3.org/2000/svg\",\"g\");g.setAttribute(\"class\",\"flowchart-link\"),g.setAttribute(\"data-link_id\",t),h.appendChild(g),e.internal.els.line1=f,e.internal.els.line2=k,e.internal.els.line3=b,e.internal.els.line4=v,e.internal.els.line5=m,g.appendChild(f),g.appendChild(k),g.appendChild(b),g.appendChild(v),g.appendChild(m),this._refreshLinkPositions(t),this.uncolorizeLink(t)},_getSubConnectors:function(t){var e=0;void 0!==t.fromSubConnector&&(e=t.fromSubConnector);var o=0;return void 0!==t.toSubConnector&&(o=t.toSubConnector),[e,o]},_refreshLinkPositions:function(t){var e=this.data.links[t],o=this._getSubConnectors(e),r=o[0],n=o[1],i=this.getConnectorPosition(e.fromOperator,e.fromConnector,r),a=this.getConnectorPosition(e.toOperator,e.toConnector,n),s=i.x,l=i.width,p=i.y,c=a.x,u=a.y,d=(this.options.distanceFromArrow,c-s<0?-(c-s):c-s),h=u-p<0?-(u-p):u-p;console.log(\"xdiff\",d),console.log(\"ydiff\",h),console.log(\"xdiff\",d);var f=h/2,k=d/2;u-p<62&&u-p>=-20&&d>=100?(e.internal.els.line1.setAttribute(\"x1\",s+l),e.internal.els.line1.setAttribute(\"y1\",p),e.internal.els.line1.setAttribute(\"x2\",s+l),e.internal.els.line1.setAttribute(\"y2\",p+80),e.internal.els.line1.setAttribute(\"stroke\",\"black\"),e.internal.els.line2.setAttribute(\"x1\",s+l),e.internal.els.line2.setAttribute(\"y1\",p+80),console.log(c-s),e.internal.els.line2.setAttribute(\"x2\",c+1.5*(c-s)),e.internal.els.line2.setAttribute(\"y2\",p+80),e.internal.els.line2.setAttribute(\"stroke\",\"black\"),e.internal.els.line3.setAttribute(\"x1\",c+1.5*(c-s)),e.internal.els.line3.setAttribute(\"y1\",p+80),e.internal.els.line3.setAttribute(\"x2\",c+1.5*(c-s)),e.internal.els.line3.setAttribute(\"y2\",p-40),e.internal.els.line3.setAttribute(\"stroke\",\"black\"),e.internal.els.line4.setAttribute(\"x1\",c+1.5*(c-s)),e.internal.els.line4.setAttribute(\"y1\",p-40),e.internal.els.line4.setAttribute(\"x2\",c+l),e.internal.els.line4.setAttribute(\"y2\",p-40),e.internal.els.line4.setAttribute(\"stroke\",\"black\"),e.internal.els.line5.setAttribute(\"x1\",c+l),e.internal.els.line5.setAttribute(\"y1\",p-40),e.internal.els.line5.setAttribute(\"x2\",c+l),e.internal.els.line5.setAttribute(\"y2\",u),e.internal.els.line5.setAttribute(\"stroke\",\"black\")):u-p<0&&0!=d?(e.internal.els.line1.setAttribute(\"x1\",s+l),e.internal.els.line1.setAttribute(\"y1\",p),e.internal.els.line1.setAttribute(\"x2\",s+l),e.internal.els.line1.setAttribute(\"y2\",p+f),e.internal.els.line1.setAttribute(\"stroke\",\"black\"),e.internal.els.line2.setAttribute(\"x1\",s+l),e.internal.els.line2.setAttribute(\"y1\",p+f),e.internal.els.line2.setAttribute(\"x2\",c+l+k),e.internal.els.line2.setAttribute(\"y2\",p+f),e.internal.els.line2.setAttribute(\"stroke\",\"black\"),e.internal.els.line3.setAttribute(\"x1\",c+l+k),e.internal.els.line3.setAttribute(\"y1\",p+f),e.internal.els.line3.setAttribute(\"x2\",c+l+k),e.internal.els.line3.setAttribute(\"y2\",u-f),e.internal.els.line3.setAttribute(\"stroke\",\"black\"),e.internal.els.line4.setAttribute(\"x1\",c+l+k),e.internal.els.line4.setAttribute(\"y1\",u-f),e.internal.els.line4.setAttribute(\"x2\",c+l),e.internal.els.line4.setAttribute(\"y2\",u-f),e.internal.els.line4.setAttribute(\"stroke\",\"black\"),e.internal.els.line5.setAttribute(\"x1\",c+l),e.internal.els.line5.setAttribute(\"y1\",u),e.internal.els.line5.setAttribute(\"x2\",c+l),e.internal.els.line5.setAttribute(\"y2\",u-f),e.internal.els.line5.setAttribute(\"stroke\",\"black\")):0==d&&u-p<0?(e.internal.els.line1.setAttribute(\"x1\",s+l),e.internal.els.line1.setAttribute(\"y1\",p),e.internal.els.line1.setAttribute(\"x2\",s+l),e.internal.els.line1.setAttribute(\"y2\",p+f),e.internal.els.line1.setAttribute(\"stroke\",\"black\"),e.internal.els.line2.setAttribute(\"x1\",s+l),e.internal.els.line2.setAttribute(\"y1\",p+f),e.internal.els.line2.setAttribute(\"x2\",s+l+200),e.internal.els.line2.setAttribute(\"y2\",p+f),e.internal.els.line2.setAttribute(\"stroke\",\"black\"),e.internal.els.line3.setAttribute(\"x1\",s+l+200),e.internal.els.line3.setAttribute(\"y1\",p+f),e.internal.els.line3.setAttribute(\"x2\",c+l+k+200),e.internal.els.line3.setAttribute(\"y2\",u-f),e.internal.els.line3.setAttribute(\"stroke\",\"black\"),e.internal.els.line4.setAttribute(\"x1\",c+l+k),e.internal.els.line4.setAttribute(\"y1\",u-f),e.internal.els.line4.setAttribute(\"x2\",c+l+k+200),e.internal.els.line4.setAttribute(\"y2\",u-f),e.internal.els.line4.setAttribute(\"stroke\",\"black\"),e.internal.els.line5.setAttribute(\"x1\",c+l),e.internal.els.line5.setAttribute(\"y1\",u),e.internal.els.line5.setAttribute(\"x2\",c+l),e.internal.els.line5.setAttribute(\"y2\",u-f),e.internal.els.line5.setAttribute(\"stroke\",\"black\")):(e.internal.els.line1.setAttribute(\"x1\",s+l),e.internal.els.line1.setAttribute(\"y1\",p),e.internal.els.line1.setAttribute(\"x2\",s+l),e.internal.els.line1.setAttribute(\"y2\",p+f),e.internal.els.line1.setAttribute(\"stroke\",\"black\"),e.internal.els.line2.setAttribute(\"x1\",s+l),e.internal.els.line2.setAttribute(\"y1\",p+f),e.internal.els.line2.setAttribute(\"x2\",c+l),e.internal.els.line2.setAttribute(\"y2\",u-f),e.internal.els.line2.setAttribute(\"stroke\",\"black\"),e.internal.els.line3.setAttribute(\"x1\",c+l),e.internal.els.line3.setAttribute(\"y1\",u-f),e.internal.els.line3.setAttribute(\"x2\",c+l),e.internal.els.line3.setAttribute(\"y2\",u),e.internal.els.line3.setAttribute(\"stroke\",\"black\"),e.internal.els.line4.setAttribute(\"x1\",0),e.internal.els.line4.setAttribute(\"y1\",0),e.internal.els.line4.setAttribute(\"x2\",0),e.internal.els.line4.setAttribute(\"y2\",0),e.internal.els.line4.setAttribute(\"stroke\",\"black\"),e.internal.els.line5.setAttribute(\"x1\",0),e.internal.els.line5.setAttribute(\"y1\",0),e.internal.els.line5.setAttribute(\"x2\",0),e.internal.els.line5.setAttribute(\"y2\",0),e.internal.els.line5.setAttribute(\"stroke\",\"black\"))},getOperatorCompleteData:function(t){void 0===t.internal&&(t.internal={}),this._refreshInternalProperties(t);var e=$.extend(!0,{},t.internal.properties);for(var o in console.log(\"infos.inputs\",e.inputs),e.inputs)e.inputs.hasOwnProperty(o)&&null==e.inputs[o]&&delete e.inputs[o];for(var r in e.outputs)e.outputs.hasOwnProperty(r)&&null==e.outputs[r]&&delete e.outputs[r];return void 0===e.class&&(e.class=this.options.defaultOperatorClass),e},_getOperatorFullElement:function(t){var e=this.getOperatorCompleteData(t);console.log(\"infos\",e),\"decider\"==e.func&&console.log(\"Decider\"),$operator_diamond_item_count=$('<div class=\"item_count\"></div>');var o=$('<div class=\"flowchart-operator\"></div>');o.addClass(e.class),o.addClass(e.shape),console.log(\"info.class\",e.class),$container=$('<div class=\"container\"></div>'),$container.appendTo(o),$row=$('<div class=\"row\"></div>'),$row.appendTo($container),$icon=$(\"<div class='col-sm-2'></div>\"),$mailIcon=$('<span class=\"glyphicon\" style=\"color:black;font-size:30px\">&#x2709;</span>'),$mailIcon.appendTo($icon),$icon.appendTo($row),$title=$(\"<div class='col-sm-10'></div>\"),$title.appendTo($row);var r=$('<input type=\"text\" style=\"width:100%;display:none;height:90%\" class=\"input-inside-operator\"/>'),n=$('<div class=\"flowchart-operator-title\"></div>'),i=$(\"<div class='flowchart-span-title'>\"+e.title+\"</div>\");n.html(i),n.appendTo($title),r.appendTo(n),n.addClass(\"centerText\");var a=$('<div class=\"flowchart-operator-inputs-outputs\"></div>');a.appendTo(o);var s=$('<div class=\"flowchart-operator-inputs\"></div>');s.appendTo(a);var l=$('<div class=\"flowchart-operator-outputs\"></div>');l.appendTo(a);var p=this,c={},u={},d={},h={},f={operator:o,title:n,connectorSets:d,connectors:h,connectorArrows:c,connectorSmallArrows:u,func:e.func};function k(t,e,o,r,n,i){var a=$('<div class=\"flowchart-operator-connector-set\"></div>');\"output_1\"==t&&\"decider\"==i&&a.css(\"height\",0),a.data(\"connector_type\",r),a.appendTo(o),c[t]=[],u[t]=[],h[t]=[],d[t]=a,p._createSubConnector(t,e,f,r,n,f.func)}for(var b in e.inputs)if(e.inputs.hasOwnProperty(b)){var v=!1;2==Object.keys(e.inputs).length&&\"input_0\"==b&&(v=!0),k(b,e.inputs[b],s,\"inputs\",v)}for(var m in console.log(\"infos\",e.func),e.outputs)if(e.outputs.hasOwnProperty(m)){v=!1;2==Object.keys(e.outputs).length&&\"output_0\"==m&&(v=!0),k(m,e.outputs[m],l,\"outputs\",v,e.func)}return f},_createSubConnector:function(t,e,o,r,n,i){var a=o.connectorSets[t],s=o.connectors[t].length,l=$('<div class=\"flowchart-operator-connector\"></div>');n&&\"decider\"!=i&&(l=$('<div class=\"flowchart-operator-connector\" style=\"bottom:20px\"></div>')),l.appendTo(a),l.data(\"connector\",t),l.data(\"sub_connector\",s);var p=$('<div class=\"flowchart-operator-connector-arrow\"></div>');p.appendTo(l);var c=$('<div class=\"flowchart-operator-connector-small-arrow\" style=\"position:relative\"></div>');\"inputs\"==r&&(c=$('<div class=\"flowchart-operator-connector-small-arrow\" style=\"position:relative\"></div>')),c.appendTo(p),o.connectors[t].push(l),o.connectorArrows[t].push(p),o.connectorSmallArrows[t].push(c)},getOperatorElement:function(t){return this._getOperatorFullElement(t).operator},addOperator:function(t){for(;void 0!==this.data.operators[this.operatorNum];)this.operatorNum++;if(this.createOperator(this.operatorNum,t),\"Reject\"==t.properties.title){let n,i,a,s,l,p,c=t.properties.random;for(var e in this.data.operators)this.data.operators[e].properties.random==c&&\"Approve\"==this.data.operators[e].properties.title&&(n=this.data.operators[e],s=e),this.data.operators[e].properties.random==c&&\"Reject\"==this.data.operators[e].properties.title&&(i=this.data.operators[e],l=e),this.data.operators[e].properties.random==c&&\"Approve\"!=this.data.operators[e].properties.title&&\"Reject\"!=this.data.operators[e].properties.title&&(a=this.data.operators[e],p=e);var o={fromOperator:p,fromConnector:\"output_0\",fromSubConnector:0,toOperator:s,toConnector:\"input_0\",toSubConnector:0},r={fromOperator:p,fromConnector:\"output_1\",fromSubConnector:0,toOperator:l,toConnector:\"input_0\",toSubConnector:0};this.addLink(o),this.addLink(r)}return this.operatorNum},createOperator:function(t,e){e.internal={},this._refreshInternalProperties(e);var o=this._getOperatorFullElement(e);if(console.log(\"operatorData\",e),!this.callbackEvent(\"operatorCreate\",[t,e,o]))return!1;var r=this.options.grid;r&&(e.top=Math.round(e.top/r)*r,e.left=Math.round(e.left/r)*r),console.log(e.top),console.log(e.left),o.operator.appendTo(this.objs.layers.operators),o.operator.css({position:\"absolute\",top:e.top,left:e.left}),o.operator.data(\"operator_id\",t),this.data.operators[t]=e,this.data.operators[t].internal.els=o,t==this.selectedOperatorId&&this._addSelectedClass(t);var n,i,a=this;function s(t,o){for(var r in e.top=o.top,e.left=o.left,a.data.links)if(a.data.links.hasOwnProperty(r)){var n=a.data.links[r];n.fromOperator!=t&&n.toOperator!=t||a._refreshLinkPositions(r)}}this.options.canUserMoveOperators&&o.operator.draggable({containment:!e.internal.properties.uncontained&&this.element,handle:\".flowchart-operator-title\",start:function(t,e){if(null==a.lastOutputConnectorClicked){var o=a.element.offset();n=(t.pageX-o.left)/a.positionRatio-parseInt($(t.target).css(\"left\")),i=(t.pageY-o.top)/a.positionRatio-parseInt($(t.target).css(\"top\"))}else t.preventDefault()},drag:function(t,r){if(a.options.grid){var l=a.options.grid,p=a.element.offset();if(console.log(p),r.position.left=Math.round(((t.pageX-p.left)/a.positionRatio-n)/l)*l,console.log(\"ui.position.left\",r.position.left),r.position.top=Math.round(((t.pageY-p.top)/a.positionRatio-i)/l)*l,console.log(!e.internal.properties.uncontained),!e.internal.properties.uncontained){const t=parseInt($(\"#example\").css(\"width\")),e=parseInt($(\"#example\").css(\"height\")),o=19.5/(t/100)*t,n=21/(e/100)*e;console.log(e);$(this);r.position.left>o?r.position.left=o:r.position.left<0&&(r.position.left=0),r.position.top<0?r.position.top=0:r.position.top>n&&(r.position.top=n)}r.offset.left=Math.round(r.position.left+p.left),r.offset.top=Math.round(r.position.top+p.top),o.operator.css({left:r.position.left,top:r.position.top})}s($(this).data(\"operator_id\"),r.position),console.log(\"ui.position\",r.position)},stop:function(t,e){a._unsetTemporaryLink();var o=$(this).data(\"operator_id\");s(o,e.position),a.callbackEvent(\"operatorMoved\",[o,e.position]),a.callbackEvent(\"afterChange\",[\"operator_moved\"])}});this.callbackEvent(\"afterChange\",[\"operator_create\"])},_connectorClicked:function(t,e,o,r){if(\"outputs\"==r){new Date;this.lastOutputConnectorClicked={operator:t,connector:e,subConnector:o},console.log(\"this.lastOutputConnectorClicked\",this.lastOutputConnectorClicked),this.objs.layers.temporaryLink.show(),console.log(\"this.objs.layers.temporaryLink\",this.objs.layers.temporaryLink);var n=this.getConnectorPosition(t,e,o);console.log(\"position\",n);var i=n.x+n.width,a=n.y;console.log(\"x\",i),console.log(\"y\",a),this.objs.temporaryLink.setAttribute(\"x1\",i.toString()),this.objs.temporaryLink.setAttribute(\"y1\",a.toString()),this._mousemove(i,a)}if(\"inputs\"==r&&null!=this.lastOutputConnectorClicked){console.log(\"connectorCategory\",r),console.log(\"this.lastOutputConnectorClicked\",this.lastOutputConnectorClicked);var s={fromOperator:this.lastOutputConnectorClicked.operator,fromConnector:this.lastOutputConnectorClicked.connector,fromSubConnector:this.lastOutputConnectorClicked.subConnector,toOperator:t,toConnector:e,toSubConnector:o};console.log(\"linkData\",s),console.log(s),this._unsetTemporaryLink(),this.addLink(s)}},_unsetTemporaryLink:function(){this.lastOutputConnectorClicked=null,this.objs.layers.temporaryLink.hide();let t=$(\".flowchart-temporary-link-layer line:first-child\"),e=t.attr(\"x1\"),o=t.attr(\"y1\");t[0].setAttribute(\"x2\",e),t[0].setAttribute(\"y2\",o),$(\".flowchart-temporary-link-layer\").html($(\".flowchart-temporary-link-layer line:first-child\")),this.objs.temporaryLink=$(\".flowchart-temporary-link-layer line:last-child\")[0]},_mousemove:function(t,e,o){null!=this.lastOutputConnectorClicked&&(this.objs.temporaryLink.setAttribute(\"x2\",t),this.objs.temporaryLink.setAttribute(\"y2\",e))},_click:function(t,e,o){var r=$(o.target),n=$(\".flowchart-temporary-link-layer\"),i=$(\".flowchart-temporary-link-layer line:last-child\"),a=document.createElementNS(\"http://www.w3.org/2000/svg\",\"line\"),s=i.attr(\"x1\"),l=(i.attr(\"y1\"),i.attr(\"x2\")),p=i.attr(\"y2\");null!=this.lastOutputConnectorClicked&&(console.log(s),console.log(t),console.log(t-s),this.objs.temporaryLink.setAttribute(\"x2\",t),this.objs.temporaryLink.setAttribute(\"y2\",e),\"svg\"==r[0].tagName&&(a.setAttribute(\"x1\",l),a.setAttribute(\"y1\",p),a.setAttribute(\"x2\",l),a.setAttribute(\"y2\",p),a.setAttribute(\"stroke\",\"black\"),a.setAttribute(\"fill\",\"none\"),n.append(a),this.objs.temporaryLink=$(\".flowchart-temporary-link-layer line:last-child\")[0],console.log(\"Time to fight lo\"))),0==r.closest(\".flowchart-operator\").length&&this.unselectOperator()},_removeSelectedClassOperators:function(){this.objs.layers.operators.find(\".flowchart-operator\").removeClass(\"selected\")},unselectOperator:function(){if(null!=this.selectedOperatorId){if(!this.callbackEvent(\"operatorUnselect\",[]))return;this._removeSelectedClassOperators(),this.selectedOperatorId=null}},_addSelectedClass:function(t){this.data.operators[t].internal.els.operator.addClass(\"selected\")},callbackEvent:function(t,e){var o=\"on\"+t.charAt(0).toUpperCase()+t.slice(1),r=this.options[o].apply(this,e);if(!1!==r){var n={result:r};this.element.trigger(t,e.concat([n])),r=n.result}return r},selectOperator:function(t){this.selectedLinkId=null,$(\".flowchart-link line\").each(function(){$(this).attr(\"stroke\",\"black\")}),this.callbackEvent(\"operatorSelect\",[t])&&(this.unselectLink(),this._removeSelectedClassOperators(),this._addSelectedClass(t),this.selectedOperatorId=t)},addClassOperator:function(t,e){this.data.operators[t].internal.els.operator.addClass(e)},removeClassOperator:function(t,e){this.data.operators[t].internal.els.operator.removeClass(e)},removeClassOperators:function(t){console.log(\"removeClass\",t),this.objs.layers.operators.find(\".flowchart-operator\").removeClass(t)},_addHoverClassOperator:function(t){this.data.operators[t].internal.els.operator.addClass(\"hover\")},_removeHoverClassOperators:function(){this.objs.layers.operators.find(\".flowchart-operator\").removeClass(\"hover\")},_operatorMouseOver:function(t){this.callbackEvent(\"operatorMouseOver\",[t])&&this._addHoverClassOperator(t)},_operatorMouseOut:function(t){this.callbackEvent(\"operatorMouseOut\",[t])&&this._removeHoverClassOperators()},getSelectedOperatorId:function(){return this.selectedOperatorId},getSelectedLinkId:function(){return this.selectedLinkId},_shadeColor:function(t,e){var o=parseInt(t.slice(1),16),r=e<0?0:255,n=e<0?-1*e:e,i=o>>16,a=o>>8&255,s=255&o;return\"#\"+(16777216+65536*(Math.round((r-i)*n)+i)+256*(Math.round((r-a)*n)+a)+(Math.round((r-s)*n)+s)).toString(16).slice(1)},colorizeLink:function(t,e){this.data.links[t]},uncolorizeLink:function(t){this.colorizeLink(t,this.getLinkMainColor(t))},_connecterMouseOver:function(t){this.selectedLinkId!=t&&this.colorizeLink(t,this._shadeColor(this.getLinkMainColor(t),-.4))},_connecterMouseOut:function(t){this.selectedLinkId!=t&&this.uncolorizeLink(t)},unselectLink:function(){if(null!=this.selectedLinkId){if(!this.callbackEvent(\"linkUnselect\",[]))return;this.selectedLinkId=null}},selectLink:function(t){if(this.unselectLink(),!this.callbackEvent(\"linkSelect\",[t]))return;this.unselectOperator(),this.selectedLinkId=t;let e=this.data.links[t].toOperator,o=this.data.links[t].fromOperator;this.data.operators[e].properties.random&&this.data.operators[o].properties.random||($(\".flowchart-link line\").each(function(){$(this).attr(\"stroke\",\"black\")}),$(`.flowchart-link[data-link_id=${t}] line`).each(function(){$(this).attr(\"stroke\",\"red\")}))},deleteOperator:function(t){this._deleteOperator(t,!1)},_deleteOperator:function(t,e){if(!this.callbackEvent(\"operatorDelete\",[t,e]))return!1;if(!e)for(var o in this.data.links)if(this.data.links.hasOwnProperty(o)){var r=this.data.links[o];r.fromOperator!=t&&r.toOperator!=t||this._deleteLink(o,!0)}for(var n in e||t!=this.selectedOperatorId||this.unselectOperator(),this.data.operators[t].internal.els.operator.remove(),delete this.data.operators[t],this.callbackEvent(\"afterChange\",[\"operator_delete\"]),this.data.links)console.log(this.data.links),console.log(n),this._refreshLinkPositions(n)},deleteLink:function(t){let e=this.data.links[t].fromOperator,o=this.data.links[t].toOperator;this.data.operators[e].properties.random&&this.data.operators[o].properties.random||this._deleteLink(t,!1)},_deleteLink:function(t,e){if(this.selectedLinkId==t&&this.unselectLink(),this.callbackEvent(\"linkDelete\",[t,e])||e){this.colorizeLink(t,\"transparent\");var o=this.data.links[t],r=o.fromOperator,n=o.fromConnector,i=o.toOperator,a=o.toConnector;o.internal.els.overallGroup.remove(),delete this.data.links[t],this._cleanMultipleConnectors(r,n,\"from\"),this._cleanMultipleConnectors(i,a,\"to\"),this.callbackEvent(\"afterChange\",[\"link_delete\"])}},_cleanMultipleConnectors:function(t,e,o){if(this.data.operators[t].properties[\"from\"==o?\"outputs\":\"inputs\"][e].multiple){var r=-1,n=o+\"Operator\",i=o+\"Connector\",a=o+\"SubConnector\",s=this.data.operators[t].internal.els,l=s.connectors[e],p=l.length;for(var c in this.data.links)if(this.data.links.hasOwnProperty(c)){var u=this.data.links[c];u[n]==t&&u[i]==e&&r<u[a]&&(r=u[a])}for(var d=Math.min(p-r-2,p-1),h=0;h<d;h++)l[l.length-1].remove(),l.pop(),s.connectorArrows[e].pop(),s.connectorSmallArrows[e].pop()}},deleteSelected:function(){if(null!=this.selectedLinkId&&this.deleteLink(this.selectedLinkId),null!=this.selectedOperatorId&&(console.log(this.data.operators),this.data.operators[this.selectedOperatorId].properties.random||this.deleteOperator(this.selectedOperatorId),this.data.operators[this.selectedOperatorId].properties.random&&\"Reject\"!=this.data.operators[this.selectedOperatorId].properties.title&&\"Approve\"!=this.data.operators[this.selectedOperatorId].properties.title)){let e=this.data.operators[this.selectedOperatorId].properties.random;for(var t in this.data.operators)this.data.operators[t].properties.random==e&&\"Approve\"==this.data.operators[t].properties.title&&this.deleteOperator(t);for(var t in this.data.operators)this.data.operators[t].properties.random==e&&\"Reject\"==this.data.operators[t].properties.title&&this.deleteOperator(t);for(var t in this.data.operators)this.data.operators[t].properties.random==e&&\"Approve\"!=this.data.operators[t].properties.title&&\"Reject\"!=this.data.operators[t].properties.title&&this.deleteOperator(t)}},setPositionRatio:function(t){this.positionRatio=t},getPositionRatio:function(){return this.positionRatio},getData:function(){var t=[\"operators\",\"links\"],e={};for(var o in e.operators=$.extend(!0,{},this.data.operators),e.links=$.extend(!0,{},this.data.links),t)if(t.hasOwnProperty(o)){var r=t[o];for(var n in e[r])e[r].hasOwnProperty(n)&&delete e[r][n].internal}return e.operatorTypes=this.data.operatorTypes,e},setOperatorTitle:function(t,e){this.data.operators[t].internal.els.title.html(e),void 0===this.data.operators[t].properties&&(this.data.operators[t].properties={}),this.data.operators[t].properties.title=e,this._refreshInternalProperties(this.data.operators[t]),this.callbackEvent(\"afterChange\",[\"operator_title_change\"])},getOperatorTitle:function(t){return this.data.operators[t].internal.properties.title},setOperatorData:function(t,e){console.log(\"setOperatorData\",t,e);var o=this.getOperatorCompleteData(e);for(var r in this.data.links)if(this.data.links.hasOwnProperty(r)){var n=this.data.links[r];(n.fromOperator==t&&void 0===o.outputs[n.fromConnector]||n.toOperator==t&&void 0===o.inputs[n.toConnector])&&this._deleteLink(r,!0)}this._deleteOperator(t,!0),this.createOperator(t,e),this.redrawLinksLayer(),this.callbackEvent(\"afterChange\",[\"operator_data_change\"])},doesOperatorExists:function(t){return void 0!==this.data.operators[t]},getOperatorData:function(t){var e=$.extend(!0,{},this.data.operators[t]);return delete e.internal,e},getOperatorFullProperties:function(t){if(void 0!==t.type){var e=this.data.operatorTypes[t.type],o={};return void 0!==t.properties&&(o=t.properties),$.extend({},e,o)}return t.properties},_refreshInternalProperties:function(t){t.internal.properties=this.getOperatorFullProperties(t)}})})}]);","extractedComments":[]}